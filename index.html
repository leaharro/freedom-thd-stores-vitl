<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VITL Stores Map</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Maps JavaScript API -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHcVkUgYLoJnNKpTecRUpAyMHU-T8HqFY&loading=async&callback=initMap"></script>
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        #map { height: 100%; width: 100%; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // Configuration - FULLY CONFIGURED FOR VITL
        const CONFIG = {
            // Your Google Sheet ID
            SHEET_ID: '1SzcwBIooLjgc8lVcXFyPM7UHc5eaav1y297VeRSOhlg',
            
            // Your Google Sheet tab name
            SHEET_NAME: 'Freedom THD Stores',
            
            // Your Google API Key
            API_KEY: 'AIzaSyBHcVkUgYLoJnNKpTecRUpAyMHU-T8HqFY',
            
            // Google Maps API Key
            MAPS_API_KEY: 'AIzaSyBHcVkUgYLoJnNKpTecRUpAyMHU-T8HqFY',
            
            // Auto-refresh interval in minutes (corporate dashboard - more frequent updates)
            REFRESH_MINUTES: 3,
            
            // VITL Filter
            OWNER_FILTER: 'VITL',
            
            // Reserve Store URL - Updated with your new Google Form
            RESERVE_URL: 'https://docs.google.com/forms/d/e/1FAIpQLSdgGe9EyaLg8RcbaRdKFTyP3PJnaoR8UrmxKMi0c_MGQ6o8FQ/viewform'
        };

        // Global variables for Google Maps
        let map = null;
        let markers = [];

        // Enhanced icons for corporate dashboard
        const Filter = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
            </svg>
        );

        const Search = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        );

        const Loader = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        const RefreshCw = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M1 4v6h6M23 20v-6h-6" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15" />
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const TrendingUp = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
            </svg>
        );

        const Building = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
            </svg>
        );

        // Initialize Google Map callback
        window.initMap = function() {
            console.log('âœ… Google Maps API loaded successfully for VITL Dashboard');
            console.log('Available Google Maps objects:', Object.keys(window.google?.maps || {}));
        };

        const VITLStoresMap = () => {
            const [stores, setStores] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState('');
            const [lastUpdated, setLastUpdated] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [statusFilter, setStatusFilter] = useState('all');
            const [stateFilter, setStateFilter] = useState('all');
            const [selectedStore, setSelectedStore] = useState(null);
            const [updateAnimation, setUpdateAnimation] = useState(false);
            const mapRef = useRef(null);
            const [mapLoaded, setMapLoaded] = useState(false);

            // Enhanced status configuration for corporate dashboard
            const getStatusColor = (status) => {
                switch (status.toLowerCase()) {
                    case 'open': return '#10B981';      // Green - available for assignment
                    case 'reserved': return '#F59E0B';  // Amber - pending activation
                    case 'staffed': return '#EF4444';   // Red - fully operational
                    default: return '#6B7280';          // Gray - unknown status
                }
            };

            const getStatusBgColor = (status) => {
                switch (status.toLowerCase()) {
                    case 'open': return '#D1FAE5';      // Light green
                    case 'reserved': return '#FEF3C7';  // Light amber
                    case 'staffed': return '#FEE2E2';   // Light red
                    default: return '#F3F4F6';          // Light gray
                }
            };

            const getStatusTextColor = (status) => {
                switch (status.toLowerCase()) {
                    case 'open': return '#065F46';      // Dark green
                    case 'reserved': return '#92400E';  // Dark amber
                    case 'staffed': return '#991B1B';   // Dark red
                    default: return '#374151';          // Dark gray
                }
            };

            const getStatusDescription = (status) => {
                switch (status.toLowerCase()) {
                    case 'open': return 'Available for Assignment';
                    case 'reserved': return 'Reserved - Pending Activation';
                    case 'staffed': return 'Fully Operational';
                    default: return 'Status Unknown';
                }
            };

            const initialize
